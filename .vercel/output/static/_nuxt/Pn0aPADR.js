import{G as z,r as V,o as G,d as I,aB as F,aC as J,B as C,aD as W,u as H,aE as h,aF as q,c as x,aG as Q,O as B,aH as M,aI as X,aJ as N,aK as Y,aL as Z,M as j,aM as $}from"./BrLmWrYa.js";const K={trailing:!0};function k(a,e=25,c={}){if(c={...K,...c},!Number.isFinite(e))throw new TypeError("Expected `wait` to be a finite number");let n,t,s=[],r,v;const l=(d,i)=>(r=A(a,d,i),r.finally(()=>{if(r=null,c.trailing&&v&&!t){const m=l(d,v);return v=null,m}}),r);return function(...d){return r?(c.trailing&&(v=d),r):new Promise(i=>{const m=!t&&c.leading;clearTimeout(t),t=setTimeout(()=>{t=null;const _=c.leading?n:l(this,d);for(const D of s)D(_);s=[]},e),m?(n=l(this,d),i(n)):s.push(i)})}}async function A(a,e,c){return await a.apply(e,c)}const L=Symbol.for("nuxt:client-only"),ra=z({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(a,{slots:e,attrs:c}){const n=V(!1);G(()=>{n.value=!0});const t=F();return t&&(t._nuxtClientOnly=!0),J(L,!0),s=>{var d;if(n.value)return(d=e.default)==null?void 0:d.call(e);const r=e.fallback||e.placeholder;if(r)return r();const v=s.fallback||s.placeholder||"",l=s.fallbackTag||s.placeholderTag||"span";return I(l,c,v)}}}),aa=a=>a==="defer"||a===!1;function sa(...a){var w;const e=typeof a[a.length-1]=="string"?a.pop():void 0;typeof a[0]!="string"&&typeof a[0]!="object"&&!(typeof a[0]=="function"&&typeof a[1]=="function")&&a.unshift(e);let[c,n,t={}]=a;const s=C(()=>W(c));if(typeof s.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof n!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const r=H(),v=()=>h.value,l=(u,y,b)=>{if(y.isHydrating)return y.payload.data[u];if(b.cause!=="refresh:manual"&&b.cause!=="refresh:hook")return y.static.data[u]};t.server??(t.server=!0),t.default??(t.default=v),t.getCachedData??(t.getCachedData=l),t.lazy??(t.lazy=!1),t.immediate??(t.immediate=!0),t.deep??(t.deep=h.deep),t.dedupe??(t.dedupe="cancel"),t._functionName,r._asyncData[s.value];const d=t.getCachedData(s.value,r,{cause:"initial"});(w=r._asyncData[s.value])!=null&&w._init||(r._asyncData[s.value]=S(r,s.value,n,t,d));const i=r._asyncData[s.value];i._deps++;const m=()=>r._asyncData[s.value].execute({cause:"initial",dedupe:t.dedupe}),_=t.server!==!1&&r.payload.serverRendered;{let u=function(o){const f=r._asyncData[o];f!=null&&f._deps&&(f._deps--,f._deps===0&&(f==null||f._off(),f._init=!1,R(r,o),f.execute=()=>Promise.resolve(),r._asyncData[o].data.value=h.value))};const y=F();if(y&&_&&t.immediate&&!y.sp&&(y.sp=[]),y&&!y._nuxtOnBeforeMountCbs){y._nuxtOnBeforeMountCbs=[];const o=y._nuxtOnBeforeMountCbs;q(()=>{o.forEach(f=>{f()}),o.splice(0,o.length)}),x(()=>o.splice(0,o.length))}const b=y&&(y._nuxtClientOnly||Q(L,!1));_&&r.isHydrating&&(i.error.value||d!=null)?i.status.value=i.error.value?"error":"success":y&&!b&&(r.payload.serverRendered&&r.isHydrating||t.lazy)&&t.immediate?y._nuxtOnBeforeMountCbs.push(m):t.immediate&&m();const O=$();if(t.watch){const o=B(t.watch,()=>{i._execute({cause:"watch",dedupe:t.dedupe})},{flush:"post"});O&&M(()=>o())}const U=B(s,(o,f)=>{var E,T;const p=((E=r._asyncData[f])==null?void 0:E.data.value)!==h.value;f&&u(f),(T=r._asyncData[o])!=null&&T._init||(r._asyncData[o]=S(r,o,n,t,t.getCachedData(o,r,{cause:"initial"}))),r._asyncData[o]._deps++,(t.immediate||p)&&r._asyncData[o].execute({cause:"initial",dedupe:t.dedupe})},{flush:"sync"});O&&M(()=>{U(),u(s.value)})}const D={data:P(()=>{var u;return(u=r._asyncData[s.value])==null?void 0:u.data}),pending:P(()=>{var u;return(u=r._asyncData[s.value])==null?void 0:u.pending}),status:P(()=>{var u;return(u=r._asyncData[s.value])==null?void 0:u.status}),error:P(()=>{var u;return(u=r._asyncData[s.value])==null?void 0:u.error}),refresh:(...u)=>r._asyncData[s.value].execute(...u),execute:(...u)=>r._asyncData[s.value].execute(...u),clear:()=>R(r,s.value)},g=Promise.resolve(r._asyncDataPromises[s.value]).then(()=>D);return Object.assign(g,D),g}function P(a){return C({get(){var e;return(e=a())==null?void 0:e.value},set(e){const c=a();c&&(c.value=e)}})}async function na(a){await new Promise(c=>X(c)),await H().hooks.callHookParallel("app:data:refresh",void 0)}function R(a,e){e in a.payload.data&&(a.payload.data[e]=void 0),e in a.payload._errors&&(a.payload._errors[e]=h.errorValue),a._asyncData[e]&&(a._asyncData[e].data.value=j(a._asyncData[e]._default()),a._asyncData[e].error.value=h.errorValue,a._asyncData[e].status.value="idle"),e in a._asyncDataPromises&&(a._asyncDataPromises[e]&&(a._asyncDataPromises[e].cancelled=!0),a._asyncDataPromises[e]=void 0)}function ea(a,e){const c={};for(const n of e)c[n]=a[n];return c}function S(a,e,c,n,t){var d;(d=a.payload._errors)[e]??(d[e]=h.errorValue);const s=c,r=n.deep?V:N,v=t!=null,l={data:r(v?t:n.default()),pending:C(()=>l.status.value==="pending"),error:Y(a.payload._errors,e),status:N("idle"),execute:(i={})=>{if(a._asyncDataPromises[e]){if(aa(i.dedupe??n.dedupe))return a._asyncDataPromises[e];a._asyncDataPromises[e].cancelled=!0}{const _=i.cause==="initial"?t:n.getCachedData(e,a,{cause:i.cause??"refresh:manual"});if(_!=null)return a.payload.data[e]=l.data.value=_,l.error.value=h.errorValue,l.status.value="success",Promise.resolve(_)}l.status.value="pending";const m=new Promise((_,D)=>{try{_(s(a))}catch(g){D(g)}}).then(async _=>{if(m.cancelled)return a._asyncDataPromises[e];let D=_;n.transform&&(D=await n.transform(_)),n.pick&&(D=ea(D,n.pick)),a.payload.data[e]=D,l.data.value=D,l.error.value=h.errorValue,l.status.value="success"}).catch(_=>{if(m.cancelled)return a._asyncDataPromises[e];l.error.value=Z(_),l.data.value=j(n.default()),l.status.value="error"}).finally(()=>{m.cancelled||delete a._asyncDataPromises[e]});return a._asyncDataPromises[e]=m,a._asyncDataPromises[e]},_execute:k((...i)=>l.execute(...i),0,{leading:!0}),_default:n.default,_deps:0,_init:!0,_hash:void 0,_off:a.hook("app:data:refresh",async i=>{(!i||i.includes(e))&&await l.execute({cause:"refresh:hook"})})};return l}export{ra as _,na as r,sa as u};
